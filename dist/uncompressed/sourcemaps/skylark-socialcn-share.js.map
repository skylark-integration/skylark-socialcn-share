{"version":3,"sources":["skylark-socialcn-share.js"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"../skylark-socialcn-share.js","sourcesContent":["define('skylark-socialcn-share/main',[\r\n    \"skylark-jquery-qrcode/QRCode\"\r\n], function(QRCode) {\r\n/**\r\n * social-share.js\r\n *\r\n * @author  52cik <fe.52cik@gmail.com>\r\n * @license MIT\r\n *\r\n * @example\r\n * <pre>\r\n * socialShare('.share-components');\r\n *\r\n * // or\r\n *\r\n * socialShare('.share-bar', {\r\n *     sites: ['qzone', 'qq', 'weibo','wechat'],\r\n *     // ...\r\n * });\r\n * </pre>\r\n */\r\n\r\n    // Initialize a variables.\r\n\r\n    var Array$indexOf = Array.prototype.indexOf;\r\n    var Object$assign = Object.assign;\r\n\r\n    var runningInWeChat = /MicroMessenger/i.test(navigator.userAgent);\r\n    var isMobileScreen = document.documentElement.clientWidth <= 768;\r\n\r\n    var image = (document.images[0] || 0).src || '';\r\n    var site = getMetaContentByName('site') || getMetaContentByName('Site') || document.title;\r\n    var title = getMetaContentByName('title') || getMetaContentByName('Title') || document.title;\r\n    var description = getMetaContentByName('description') || getMetaContentByName('Description') || '';\r\n\r\n    var defaults = {\r\n        url: location.href,\r\n        origin: location.origin,\r\n        source: site,\r\n        title: title,\r\n        description: description,\r\n        image: image,\r\n        imageSelector: undefined,\r\n\r\n        weiboKey: '',\r\n\r\n        wechatQrcodeTitle: '微信扫一扫：分享',\r\n        wechatQrcodeHelper: '<p>微信里点“发现”，扫一下</p><p>二维码便可将本文分享至朋友圈。</p>',\r\n        wechatQrcodeSize: 100,\r\n\r\n        sites: ['weibo', 'qq', 'wechat', 'tencent', 'douban', 'qzone', 'linkedin', 'diandian', 'facebook', 'twitter', 'google'],\r\n        mobileSites: [],\r\n        disabled: ['google', 'facebook', 'twitter', 'diandian'],\r\n        initialized: false\r\n    };\r\n\r\n    var templates = {\r\n        qzone: 'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url={{URL}}&title={{TITLE}}&desc={{DESCRIPTION}}&summary={{SUMMARY}}&site={{SOURCE}}',\r\n        qq: 'http://connect.qq.com/widget/shareqq/index.html?url={{URL}}&title={{TITLE}}&source={{SOURCE}}&desc={{DESCRIPTION}}&pics={{IMAGE}}&summary=\"{{SUMMARY}}\"',\r\n        tencent: 'http://share.v.t.qq.com/index.php?c=share&a=index&title={{TITLE}}&url={{URL}}&pic={{IMAGE}}',\r\n        weibo: 'https://service.weibo.com/share/share.php?url={{URL}}&title={{TITLE}}&pic={{IMAGE}}&appkey={{WEIBOKEY}}',\r\n        wechat: 'javascript:',\r\n        douban: 'http://shuo.douban.com/!service/share?href={{URL}}&name={{TITLE}}&text={{DESCRIPTION}}&image={{IMAGE}}&starid=0&aid=0&style=11',\r\n        diandian: 'http://www.diandian.com/share?lo={{URL}}&ti={{TITLE}}&type=link',\r\n        linkedin: 'http://www.linkedin.com/shareArticle?mini=true&ro=true&title={{TITLE}}&url={{URL}}&summary={{SUMMARY}}&source={{SOURCE}}&armin=armin',\r\n        facebook: 'https://www.facebook.com/sharer/sharer.php?u={{URL}}',\r\n        twitter: 'https://twitter.com/intent/tweet?text={{TITLE}}&url={{URL}}&via={{ORIGIN}}',\r\n        google: 'https://plus.google.com/share?url={{URL}}'\r\n    };\r\n\r\n\r\n    /**\r\n     * Expose API to the global\r\n     *\r\n     * @param  {String|Element} elem\r\n     * @param  {Object} options\r\n     */\r\n    var socialShare = function(elem, options) {\r\n        elem = typeof elem === 'string' ? querySelectorAlls(elem) : elem;\r\n\r\n        if (elem.length === undefined) {\r\n            elem = [elem];\r\n        }\r\n\r\n        each(elem, function(el) {\r\n            if (!el.initialized) {\r\n                share(el, options);\r\n            }\r\n        });\r\n    };\r\n\r\n    /**\r\n     * Initialize a share bar.\r\n     *\r\n     * @param {Object}        $options globals (optional).\r\n     *\r\n     * @return {Void}\r\n     */\r\n    function share(elem, options) {\r\n        var data = mixin({}, defaults, options || {}, dataset(elem));\r\n\r\n        if (data.imageSelector) {\r\n            data.image = querySelectorAlls(data.imageSelector).map(function(item) {\r\n                return item.src;\r\n            }).join('||');\r\n        }\r\n\r\n        addClass(elem, 'share-component social-share');\r\n        createIcons(elem, data);\r\n        createWechat(elem, data);\r\n\r\n        elem.initialized = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Create site icons\r\n     *\r\n     * @param {Element} elem\r\n     * @param {Object} data\r\n     */\r\n    function createIcons(elem, data) {\r\n        var sites = getSites(data);\r\n        var isPrepend = data.mode == 'prepend';\r\n\r\n        each(isPrepend ? sites.reverse() : sites, function(name) {\r\n            var url = makeUrl(name, data);\r\n            var link = data.initialized ? getElementsByClassName(elem, 'icon-' + name) : createElementByString('<a class=\"social-share-icon icon-' + name + '\"></a>');\r\n\r\n            if (!link.length) {\r\n                return true;\r\n            }\r\n\r\n            link[0].href = url;\r\n\r\n            if (name === 'wechat') {\r\n                link[0].tabindex = -1;\r\n            } else {\r\n                link[0].target = '_blank';\r\n            }\r\n\r\n            if (!data.initialized) {\r\n                isPrepend ? elem.insertBefore(link[0], elem.firstChild) : elem.appendChild(link[0]);\r\n            }\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * Create the wechat icon and QRCode.\r\n     *\r\n     * @param {Element} elem\r\n     * @param {Object} data\r\n     */\r\n    function createWechat(elem, data) {\r\n        var wechat = getElementsByClassName(elem, 'icon-wechat', 'a');\r\n\r\n        if (wechat.length === 0) {\r\n            return false;\r\n        }\r\n\r\n        var elems = createElementByString('<div class=\"wechat-qrcode\"><h4>' + data.wechatQrcodeTitle + '</h4><div class=\"qrcode\"></div><div class=\"help\">' + data.wechatQrcodeHelper + '</div></div>');\r\n        // var qrcode = getElementsByClassName(elems[0], 'qrcode', 'div');\r\n        var qrcode = $(elems[0]).find('.qrcode');\r\n\r\n        wechat[0].appendChild(elems[0]);\r\n        new QRCode(qrcode[0], { text: data.url, width: data.wechatQrcodeSize, height: data.wechatQrcodeSize });\r\n    }\r\n\r\n\r\n    /**\r\n     * Get available site lists.\r\n     *\r\n     * @param {Object} data\r\n     *\r\n     * @returns {Array}\r\n     */\r\n    function getSites(data) {\r\n        if (!data['mobileSites'].length) {\r\n            data['mobileSites'] = data['sites'];\r\n        }\r\n\r\n        var sites = (isMobileScreen ? data['mobileSites'] : data['sites']).slice(0);\r\n        var disabled = data['disabled'];\r\n\r\n        if (typeof sites == 'string') {\r\n            sites = sites.split(/\\s*,\\s*/);\r\n        }\r\n        if (typeof disabled == 'string') {\r\n            disabled = disabled.split(/\\s*,\\s*/);\r\n        }\r\n\r\n        if (runningInWeChat) {\r\n            disabled.push('wechat');\r\n        }\r\n\r\n        // Remove elements\r\n        disabled.length && each(disabled, function(it) {\r\n            sites.splice(inArray(it, sites), 1);\r\n        });\r\n\r\n        return sites;\r\n    }\r\n\r\n\r\n    /**\r\n     * Build the url of icon.\r\n     *\r\n     * @param {String} name\r\n     * @param {Object} data\r\n     *\r\n     * @returns {String}\r\n     */\r\n    function makeUrl(name, data) {\r\n\r\n        if (!data['summary']) {\r\n            data['summary'] = data['description'];\r\n        }\r\n\r\n        return templates[name].replace(/\\{\\{(\\w)(\\w*)\\}\\}/g, function(m, fix, key) {\r\n            var nameKey = name + fix + key.toLowerCase();\r\n            key = (fix + key).toLowerCase();\r\n\r\n            return encodeURIComponent((data[nameKey] === undefined ? data[key] : data[nameKey]) || '');\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * Supports querySelectorAll, jQuery, Zepto and simple selector.\r\n     *\r\n     * @param str\r\n     *\r\n     * @returns {*}\r\n     */\r\n    function querySelectorAlls(str) {\r\n        return (document.querySelectorAll || window.jQuery || window.Zepto || selector).call(document, str);\r\n    }\r\n\r\n\r\n    /**\r\n     * Simple selector.\r\n     *\r\n     * @param {String} str #ID or .CLASS\r\n     *\r\n     * @returns {Array}\r\n     */\r\n    function selector(str) {\r\n        var elems = [];\r\n\r\n        each(str.split(/\\s*,\\s*/), function(s) {\r\n            var m = s.match(/([#.])(\\w+)/);\r\n            if (m === null) {\r\n                throw Error('Supports only simple single #ID or .CLASS selector.');\r\n            }\r\n\r\n            if (m[1]) {\r\n                var elem = document.getElementById(m[2]);\r\n\r\n                if (elem) {\r\n                    elems.push(elem);\r\n                }\r\n            }\r\n\r\n            elems = elems.concat(getElementsByClassName(str));\r\n        });\r\n\r\n        return elems;\r\n    }\r\n\r\n\r\n    /**\r\n     * Add the classNames for element.\r\n     *\r\n     * @param {Element} elem\r\n     * @param {String} value\r\n     */\r\n    function addClass(elem, value) {\r\n        if (value && typeof value === \"string\") {\r\n            var classNames = (elem.className + ' ' + value).split(/\\s+/);\r\n            var setClass = ' ';\r\n\r\n            each(classNames, function(className) {\r\n                if (setClass.indexOf(' ' + className + ' ') < 0) {\r\n                    setClass += className + ' ';\r\n                }\r\n            });\r\n\r\n            elem.className = setClass.slice(1, -1);\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * Get meta element content value\r\n     *\r\n     * @param {String} name\r\n     *\r\n     * @returns {String|*}\r\n     */\r\n    function getMetaContentByName(name) {\r\n        return (document.getElementsByName(name)[0] || 0).content;\r\n    }\r\n\r\n\r\n    /**\r\n     * Get elements By className for IE8-\r\n     *\r\n     * @param {Element} elem element\r\n     * @param {String} name className\r\n     * @param {String} tag tagName\r\n     *\r\n     * @returns {HTMLCollection|Array}\r\n     */\r\n    function getElementsByClassName(elem, name, tag) {\r\n        if (elem.getElementsByClassName) {\r\n            return elem.getElementsByClassName(name);\r\n        }\r\n\r\n        var elements = [];\r\n        var elems = elem.getElementsByTagName(tag || '*');\r\n        name = ' ' + name + ' ';\r\n\r\n        each(elems, function(elem) {\r\n            if ((' ' + (elem.className || '') + ' ').indexOf(name) >= 0) {\r\n                elements.push(elem);\r\n            }\r\n        });\r\n\r\n        return elements;\r\n    }\r\n\r\n\r\n    /**\r\n     * Create element by string.\r\n     *\r\n     * @param {String} str\r\n     *\r\n     * @returns {NodeList}\r\n     */\r\n    function createElementByString(str) {\r\n        var div = $(\"<div>\").html(str);\r\n        // var div = document.createElement('div');\r\n        // div.innerHTML = str;\r\n\r\n        // return div.childNodes;\r\n        return $(div[0].firstChild);\r\n    }\r\n\r\n\r\n    /**\r\n     * Merge objects.\r\n     *\r\n     * @returns {Object}\r\n     */\r\n    function mixin() {\r\n        var args = arguments;\r\n\r\n        if (Object$assign) {\r\n            return Object$assign.apply(null, args);\r\n        }\r\n\r\n        var target = {};\r\n\r\n        each(args, function(it) {\r\n            each(it, function(v, k) {\r\n                target[k] = v;\r\n            });\r\n        });\r\n\r\n        return args[0] = target;\r\n    }\r\n\r\n\r\n    /**\r\n     * Get dataset object.\r\n     *\r\n     * @param {Element} elem\r\n     *\r\n     * @returns {Object}\r\n     */\r\n    function dataset(elem) {\r\n        if (elem.dataset) {\r\n            return JSON.parse(JSON.stringify(elem.dataset));\r\n        }\r\n\r\n        var target = {};\r\n\r\n        if (elem.hasAttributes()) {\r\n            each(elem.attributes, function(attr) {\r\n                var name = attr.name;\r\n                if (name.indexOf('data-') !== 0) {\r\n                    return true;\r\n                }\r\n\r\n                name = name.replace(/^data-/i, '')\r\n                    .replace(/-(\\w)/g, function(all, letter) {\r\n                        return letter.toUpperCase();\r\n                    });\r\n\r\n                target[name] = attr.value;\r\n            });\r\n\r\n            return target;\r\n        }\r\n\r\n        return {};\r\n    }\r\n\r\n\r\n    /**\r\n     * found element in the array.\r\n     *\r\n     * @param {Array|Object} elem\r\n     * @param {Array} arr\r\n     * @param {Number} i\r\n     *\r\n     * @returns {Number}\r\n     */\r\n    function inArray(elem, arr, i) {\r\n        var len;\r\n\r\n        if (arr) {\r\n            if (Array$indexOf) {\r\n                return Array$indexOf.call(arr, elem, i);\r\n            }\r\n\r\n            len = arr.length;\r\n            i = i ? i < 0 ? Math.max(0, len + i) : i : 0;\r\n\r\n            for (; i < len; i++) {\r\n                // Skip accessing in sparse arrays\r\n                if (i in arr && arr[i] === elem) {\r\n                    return i;\r\n                }\r\n            }\r\n        }\r\n\r\n        return -1;\r\n    }\r\n\r\n\r\n    /**\r\n     * Simple each.\r\n     *\r\n     * @param {Array|Object} obj\r\n     * @param {Function} callback\r\n     *\r\n     * @returns {*}\r\n     */\r\n    function each(obj, callback) {\r\n        var length = obj.length;\r\n\r\n        if (length === undefined) {\r\n            for (var name in obj) {\r\n                if (obj.hasOwnProperty(name)) {\r\n                    if (callback.call(obj[name], obj[name], name) === false) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            for (var i = 0; i < length; i++) {\r\n                if (callback.call(obj[i], obj[i], i) === false) {\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return socialShare;\r\n    // socialShare('.social-share, .share-component');\r\n});\ndefine('skylark-socialcn-share', ['skylark-socialcn-share/main'], function (main) { return main; });\n\n"]}